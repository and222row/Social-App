"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[352],{5539:function(e,t,o){o.d(t,{Z:function(){return P}});var n=o(7437),A=o(2265),s=o(8024),r=o(270),a=o(7573),i=o(4037),l=o(4696),d=o(2879),c=o(5462),u=o(335),m=o(511),h=o(8713),g=o(9678),p=o(2986),x=o(5792),f=o(6604),v=o(6648),Z=o(6463),j=o(1326),C=o(1002),w=o(6548),b={src:"/_next/static/media/profile.4d16f731.jpg",height:150,width:150,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABkI//xAAWEAADAAAAAAAAAAAAAAAAAAACEhP/2gAIAQEAAQUCQZf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwGv/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwF//8QAFxAAAwEAAAAAAAAAAAAAAAAAABExYf/aAAgBAQAGPwJ7T//EABkQAAEFAAAAAAAAAAAAAAAAAAEAITFR8P/aAAgBAQABPyEgZxFL/9oADAMBAAIAAwAAABAP/8QAFREBAQAAAAAAAAAAAAAAAAAAAEH/2gAIAQMBAT8Qh//EABURAQEAAAAAAAAAAAAAAAAAAAAB/9oACAECAQE/EI//xAAaEAEAAgMBAAAAAAAAAAAAAAARASEAMUFh/9oACAEBAAE/EIRvgzcAs9eLn//Z",blurWidth:8,blurHeight:8},y=o(9381),E=o(1444),B=o(8460),k=o(4962);function P(e){var t,o,s,P,I,Q,z,S,O,_;let{postObj:D,isAllComments:F=!1}=e,U=(0,E.I0)(),[R,T]=A.useState(!1),M=(0,y.TA)({initialValues:{content:"",post:D._id},onSubmit:function(e){console.log(e),U((0,B.Ir)(e)).then(e=>{"success"==e.payload.data.message?(k.ZP.success("Comment added Successfuly",{position:"top-right"}),console.log(e),U((0,B.Bd)()),U((0,B.ww)(30)),U((0,B.e7)(D._id)),M.resetForm()):console.log(e)})}}),L=(0,Z.useRouter)(),N=e=>{L.push("/user/".concat(e))},H=e=>{if(void 0===e)return b;let t=e.split("/");return"undefined"==t[t.length-1]?b:e},J=e=>{L.push("/post/".concat(e))};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(r.Z,{sx:{width:"100%"},children:[(0,n.jsx)(a.Z,{avatar:(0,n.jsx)(c.Z,{onClick:()=>N(D.user._id),sx:{bgcolor:h.Z[500]},"aria-label":"recipe",children:(0,n.jsx)(v.default,{src:H(null==D?void 0:D.user.photo),alt:null==D?void 0:D.user.name,height:50,width:50})}),action:(0,n.jsx)(u.Z,{"aria-label":"settings",children:(0,n.jsx)(x.Z,{})}),title:D.user.name,subheader:D.createdAt,titleTypographyProps:{sx:{width:"fit-content",cursor:"pointer"},onClick:()=>N(D.user._id)}}),(0,n.jsx)(l.Z,{children:(0,n.jsx)(m.Z,{variant:"body2",color:"text.secondary",children:D.body})}),!!D.image&&(0,n.jsx)(i.Z,{component:"img",height:"194",image:D.image,alt:null==D?void 0:D.user.name,sx:{objectFit:"contain"}}),(0,n.jsxs)(d.Z,{disableSpacing:!0,sx:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)(u.Z,{"aria-label":"add to favorites",children:(0,n.jsx)(g.Z,{})}),(0,n.jsx)(u.Z,{"aria-label":"share",children:(0,n.jsx)(p.Z,{})}),(0,n.jsx)(u.Z,{"aria-label":"share",children:(0,n.jsx)(f.Z,{})})]}),(0,n.jsxs)(j.Z,{component:"section",children:[(0,n.jsxs)("form",{onSubmit:M.handleSubmit,children:[(0,n.jsx)(C.Z,{fullWidth:!0,placeholder:"add your comment",value:M.values.content,onChange:M.handleChange,onBlur:M.handleBlur,name:"content",id:"content"}),(0,n.jsx)(w.Z,{sx:{backgroundColor:"blue",color:"white",marginInline:"auto",display:"block",":hover":{backgroundColor:"green"},marginTop:"2px"},type:"submit",children:"add comment"})]}),(null===(t=D.comments)||void 0===t?void 0:t.length)&&F?D.comments.map(e=>(0,n.jsxs)(j.Z,{children:[(0,n.jsx)(a.Z,{avatar:(0,n.jsx)(c.Z,{onClick:()=>N(e.commentCreator._id),sx:{bgcolor:h.Z[500]},"aria-label":"recipe",children:(0,n.jsx)(v.default,{src:H(null==e?void 0:e.commentCreator.photo),alt:null==e?void 0:e.commentCreator.name,height:50,width:50})}),action:(0,n.jsx)(u.Z,{"aria-label":"settings",children:(0,n.jsx)(x.Z,{})}),title:e.commentCreator.name,subheader:D.createdAt,titleTypographyProps:{sx:{width:"fit-content",cursor:"pointer"},onClick:()=>{var e;return N(null===(e=D.comments)||void 0===e?void 0:e[0].commentCreator._id)}}}),(0,n.jsx)(l.Z,{children:(0,n.jsx)(m.Z,{variant:"body2",color:"text.secondary",children:e.content})})]},e._id)):(0,n.jsxs)(j.Z,{children:[(0,n.jsx)(a.Z,{avatar:(0,n.jsx)(c.Z,{onClick:()=>{var e,t;return N(null===(t=D.comments)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.commentCreator._id)},sx:{bgcolor:h.Z[500]},"aria-label":"recipe",children:(0,n.jsx)(v.default,{src:H(null===(s=D.comments)||void 0===s?void 0:null===(o=s[0])||void 0===o?void 0:o.commentCreator.photo),alt:null===(I=D.comments)||void 0===I?void 0:null===(P=I[0])||void 0===P?void 0:P.commentCreator.name,height:50,width:50})}),action:(0,n.jsx)(u.Z,{"aria-label":"settings",children:(0,n.jsx)(x.Z,{})}),title:null===(z=D.comments)||void 0===z?void 0:null===(Q=z[0])||void 0===Q?void 0:Q.commentCreator.name,subheader:D.createdAt,titleTypographyProps:{sx:{width:"fit-content",cursor:"pointer"},onClick:()=>{var e,t;return N(null===(t=D.comments)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.commentCreator._id)}}}),(0,n.jsx)(l.Z,{children:(0,n.jsx)(m.Z,{variant:"body2",color:"text.secondary",children:null===(O=D.comments)||void 0===O?void 0:null===(S=O[0])||void 0===S?void 0:S.content})}),((null===(_=D.comments)||void 0===_?void 0:_.length)||0)>1&&(0,n.jsx)(m.Z,{onClick:()=>J(D._id),component:"p",variant:"h6",sx:{color:"white",textAlign:"center",cursor:"pointer",width:"fit-content",backgroundColor:"yellowgreen",marginInline:"auto",my:"5px",p:"10px",borderRadius:"10px",transition:"all 300ms",":hover":{backgroundColor:"goldenrod"}},children:"view more comments"})]})]})]})})}(0,s.ZP)(e=>{let{expand:t,...o}=e;return(0,n.jsx)(u.Z,{...o})})(e=>{let{theme:t,expand:o}=e;return{transform:o?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})}})},918:function(e,t,o){o.d(t,{Z:function(){return s}});var n=o(7437),A=o(1287);function s(){return(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,n.jsx)(A.Z,{})})}o(2265)},8460:function(e,t,o){o.d(t,{Bd:function(){return i},Ir:function(){return r},e7:function(){return s},q2:function(){return a},ww:function(){return l}});var n=o(6862),A=o(8472);let s=(0,n.hg)("posts/getPost",async function(e){return await A.Z.get("https://linked-posts.routemisr.com/posts/".concat(e),{headers:{token:localStorage.getItem("loggedUser")}})}),r=(0,n.hg)("posts/addComment",async function(e){return await A.Z.post("https://linked-posts.routemisr.com/comments",e,{headers:{token:localStorage.getItem("loggedUser")}})}),a=(0,n.hg)("posts/addPost",async function(e){let{body:t,image:o}=e;try{let e=new FormData;e.append("body",t),o&&e.append("image",o);let n=await A.Z.post("https://linked-posts.routemisr.com/posts",e,{headers:{"Content-Type":"multipart/form-data",token:localStorage.getItem("loggedUser")||""}});return console.log("actual response ====> ",n),n.data}catch(e){throw console.error(e),e}}),i=(0,n.hg)("posts/getPosts",async function(){return await A.Z.get("https://linked-posts.routemisr.com/posts?limit=40",{headers:{token:localStorage.getItem("loggedUser")}}).then(e=>e)}),l=(0,n.hg)("posts/getUserPosts",async function(e){return await A.Z.get("https://linked-posts.routemisr.com/users/".concat(e,"/posts?limit=30"),{headers:{token:localStorage.getItem("loggedUser")}})}),d=(0,n.oM)({name:"posts",initialState:{allPosts:null,specificPost:null,userPosts:null},reducers:{},extraReducers:function(e){e.addCase(i.fulfilled,function(e,t){console.log("action",t.payload.data.posts),e.allPosts=t.payload.data.posts}),e.addCase(s.fulfilled,function(e,t){e.specificPost=t.payload.data.post}),e.addCase(r.fulfilled,function(e,t){console.log(t)}),e.addCase(a.fulfilled,function(e,t){console.log("Post Added => ",t.payload)}),e.addCase(l.fulfilled,function(e,t){console.log("user posts ",t.payload.data.posts),e.userPosts=t.payload.data.posts})}});t.ZP=d.reducer}}]);